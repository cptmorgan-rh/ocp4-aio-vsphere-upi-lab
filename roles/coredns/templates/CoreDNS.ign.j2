{
  "ignition": {
    "config": {
      "replace": {
        "verification": {}
      }
    },
    "proxy": {},
    "security": {
      "tls": {}
    },
    "timeouts": {},
    "version": "3.1.0"
  },
  "passwd": {
    "users": [
      {
        "name": "core",
        "sshAuthorizedKeys": [
          "{{ config.installer_ssh_key }}"
        ]
      }
    ]
  },
  "storage": {
    "files": [
      {
        "group": {},
        "overwrite": false,
        "path": "/opt/coredns/Corefile",
        "user": {},
        "contents": {
          "source": "data:text/plain;charset=utf-8;base64,{{ Corefile_b64 }}",
          "verification": {}
        },
        "mode": 420
      },
      {
        "group": {},
        "overwrite": false,
        "path": "/opt/coredns/coredns.db",
        "user": {},
        "contents": {
          "source": "data:text/plain;charset=utf-8;base64,{{ coredns_db_b64 }}",
          "verification": {}
          },
          "mode": 420
      }
    ]
  },
  "systemd": {
    "units": [
      {
        "contents": "[Unit]\nDescription=coredns\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nTimeoutStartSec=0\nExecStartPre=-/bin/podman kill coredns\nExecStartPre=-/bin/podman rm coredns\nExecStartPre=/bin/podman pull quay.io/openshift/origin-coredns\nExecStart=/bin/podman run --name coredns \\\n  --net=host \\\n  --privileged \\\n  -v /opt/coredns/:/root/:Z \\\n  quay.io/openshift/origin-coredns -conf /root/Corefile\n\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "coredns.service"
      }
    ]
  }
}
